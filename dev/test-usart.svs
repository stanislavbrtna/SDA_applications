function init {
	scr = sys pAddScreen();
	btn = sys pAddButton(1,1,5,2, "Send", scr);
	btn2 = sys pAddButton(6,1,10,2, "Recieve", scr);
	txt = sys pAddText(1, 3, 10, 6, "", scr);
	sys pSetMainScr(scr);

	# external pin defines
	sys ePinDef(5, PIN_ALT, PIN_NOPULL);
	sys ePinDef(6, PIN_ALT, PIN_NOPULL);
}

function update {

	if (sys pGetEventC(btn) == EV_RELEASED) {
		sys serialTrs("test" + a);
		a = a +1;
	}

	if (sys pGetEventC(btn2) == EV_RELEASED) {
		get = 1;
		i = 0;
	}

	if (get == 1) {
		x = sys serialRcv(3200);
		if (x != "") {
			sys pSetStr(txt, x);
			get = 0;
		} else {
			sys pSetStr(txt, "None (" + i +")");
			i++;
		}

		# halt after ten failures
		if (i > 10){
		  get = 0;
		}
	}
}
